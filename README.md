# SMONE - ä¸´æ—¶é‚®ç®±æœåŠ¡

ä¸€ä¸ªåŸºäº React Router v7 å’Œ Cloudflare Workers æ„å»ºçš„ç°ä»£åŒ–ä¸´æ—¶é‚®ç®±æœåŠ¡ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

- ğŸš€ **å¿«é€Ÿç”Ÿæˆ**: ä¸€é”®ç”Ÿæˆä¸´æ—¶é‚®ç®±åœ°å€
- âœ¨ **è‡ªå®šä¹‰å‰ç¼€**: æ”¯æŒä½¿ç”¨è‡ªå®šä¹‰å‰ç¼€åˆ›å»ºä¸ªæ€§åŒ–é‚®ç®±åœ°å€
- ğŸ² **å¤šåŸŸåæ”¯æŒ**: éšæœºåŸŸåé€‰æ‹©å™¨ï¼Œæ”¯æŒå¤šä¸ªåŸŸåé…ç½®
- ğŸ”„ **å®æ—¶é¢„è§ˆ**: è¾“å…¥æ—¶å®æ—¶é¢„è§ˆå°†è¦ç”Ÿæˆçš„é‚®ç®±åœ°å€
- ğŸ“§ **å®æ—¶æ¥æ”¶**: å³æ—¶æ¥æ”¶å’ŒæŸ¥çœ‹é‚®ä»¶ï¼Œè‡ªåŠ¨åˆ·æ–°æ”¶ä»¶ç®±
- ğŸ”’ **éšç§ä¿æŠ¤**: é‚®ç®±åˆ°æœŸåè‡ªåŠ¨åˆ é™¤æ•°æ®
- ğŸ“± **å“åº”å¼è®¾è®¡**: å®Œç¾é€‚é…æ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
- âš¡ï¸ **æ— æœåŠ¡å™¨æ¶æ„**: åŸºäº Cloudflare Workersï¼Œå…¨çƒåŠ é€Ÿ
- ğŸ—„ï¸ **ç°ä»£åŒ–æŠ€æœ¯æ ˆ**: React Router v7ã€TypeScriptã€TailwindCSS
- ğŸ“Š **æ•°æ®å­˜å‚¨**: ä½¿ç”¨ Cloudflare D1 æ•°æ®åº“å’Œ R2 å¯¹è±¡å­˜å‚¨

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **å‰ç«¯**: React Router v7, TypeScript, TailwindCSS
- **åç«¯**: Cloudflare Workers, Email Workers
- **æ•°æ®åº“**: Cloudflare D1 (SQLite)
- **å­˜å‚¨**: Cloudflare R2 (é™„ä»¶å­˜å‚¨)
- **ORM**: Drizzle ORM
- **é‚®ä»¶è§£æ**: postal-mime

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
pnpm install
```

### é…ç½®ç¯å¢ƒå˜é‡

#### æ–¹å¼1ï¼šæœ¬åœ°å¼€å‘ç¯å¢ƒï¼ˆæ¨èç”¨äºå¼€å‘ï¼‰

å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶å¹¶é…ç½®ï¼š

```bash
cp .dev.vars.example .dev.vars
```

ç¼–è¾‘ `.dev.vars` æ–‡ä»¶ï¼Œè®¾ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡ï¼š

```bash
# Session å¯†é’¥ - ç”¨äºç”¨æˆ·ä¼šè¯åŠ å¯†
SESSION_SECRET=your-generated-secret-key

# ç”Ÿæˆæ–°çš„ Session å¯†é’¥å‘½ä»¤ï¼š
openssl rand -base64 32
```

#### æ–¹å¼2ï¼šç”Ÿäº§ç¯å¢ƒé…ç½®ï¼ˆæ¨èç”¨äºéƒ¨ç½²ï¼‰

**ä¸ºé¿å…æ¯æ¬¡éƒ¨ç½²æ—¶ç¯å¢ƒå˜é‡è¢«æ¸…ç©ºï¼Œå»ºè®®åœ¨ `wrangler.jsonc` ä¸­é…ç½®ï¼š**

```jsonc
{
  // ... å…¶ä»–é…ç½®
  "vars": {
    "ENVIRONMENT": "production",
    "SESSION_SECRET": "your-generated-secret-key",
    "AVAILABLE_DOMAINS": "smone.us,your-domain.com"
  }
}
```

**æ”¯æŒçš„ç¯å¢ƒå˜é‡ï¼š**
- `SESSION_SECRET`: ç”¨æˆ·ä¼šè¯åŠ å¯†å¯†é’¥ï¼ˆå¿…éœ€ï¼‰
- `AVAILABLE_DOMAINS`: å¯ç”¨åŸŸååˆ—è¡¨ï¼Œé€—å·åˆ†éš”ï¼ˆå¯é€‰ï¼Œé»˜è®¤ï¼šsmone.usï¼‰
  - å•ä¸ªåŸŸåï¼š`"smone.us"`
  - å¤šä¸ªåŸŸåï¼š`"smone.us,temp.email,example.org"`
  - å¤šåŸŸåæ—¶æ”¯æŒéšæœºé€‰æ‹©å’Œæ‰‹åŠ¨åˆ‡æ¢
- `ENVIRONMENT`: è¿è¡Œç¯å¢ƒæ ‡è¯†ï¼ˆå¯é€‰ï¼‰

### è®¾ç½®æ•°æ®åº“

```bash
# ç”Ÿæˆæ•°æ®åº“è¿ç§»æ–‡ä»¶
pnpm run db:generate

# åº”ç”¨è¿ç§»åˆ°æœ¬åœ°æ•°æ®åº“
pnpm run db:migrate
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
pnpm dev
```

åº”ç”¨å°†åœ¨ http://localhost:5173 å¯ç”¨ã€‚

## ğŸ¯ é«˜çº§åŠŸèƒ½

### è‡ªå®šä¹‰é‚®ç®±å‰ç¼€ç”Ÿæˆ
- æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰é‚®ç®±å‰ç¼€ï¼ˆå¦‚ï¼šwork@domain.comï¼‰
- å®æ—¶é¢„è§ˆåŠŸèƒ½ï¼Œè¾“å…¥æ—¶åŠ¨æ€æ˜¾ç¤ºå°†è¦ç”Ÿæˆçš„é‚®ç®±åœ°å€
- è‡ªåŠ¨è¿‡æ»¤æ— æ•ˆå­—ç¬¦ï¼Œç¡®ä¿é‚®ç®±åœ°å€æ ¼å¼æ­£ç¡®
- ç©ºç™½å‰ç¼€æ—¶è‡ªåŠ¨åˆ‡æ¢ä¸ºéšæœºç”Ÿæˆæ¨¡å¼

### å¤šåŸŸåéšæœºé€‰æ‹©
- æ”¯æŒé…ç½®å¤šä¸ªå¯ç”¨åŸŸå
- ğŸ² éª°å­æŒ‰é’®ï¼šä¸€é”®éšæœºé€‰æ‹©åŸŸå
- ç¯å¢ƒå˜é‡ `AVAILABLE_DOMAINS` é…ç½®åŸŸååˆ—è¡¨
- è‡ªåŠ¨è´Ÿè½½å‡è¡¡åˆ†é…é‚®ç®±åœ°å€

### æ™ºèƒ½ç”¨æˆ·ä½“éªŒ
- åŠ¨æ€æŒ‰é’®æ–‡æœ¬ï¼šæ ¹æ®è¾“å…¥çŠ¶æ€æ˜¾ç¤ºä¸åŒæ“ä½œæç¤º
- é«˜çº§é€‰é¡¹æŠ˜å é¢æ¿ï¼šä¿æŒç•Œé¢ç®€æ´çš„åŒæ—¶æä¾›å¼ºå¤§åŠŸèƒ½
- å®æ—¶è¡¨å•éªŒè¯å’Œç”¨æˆ·åé¦ˆ

## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### å¿«é€Ÿç”Ÿæˆé‚®ç®±
1. è®¿é—®ä¸»é¡µï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆéšæœºé‚®ç®±ï¼ˆå¦‚ï¼š`happy-bird-1234@smone.us`ï¼‰
2. ç‚¹å‡»å¤åˆ¶æŒ‰é’®å³å¯ä½¿ç”¨

### è‡ªå®šä¹‰é‚®ç®±å‰ç¼€
1. ç‚¹å‡» "é«˜çº§é€‰é¡¹" å±•å¼€é…ç½®é¢æ¿
2. è¾“å…¥è‡ªå®šä¹‰å‰ç¼€ï¼ˆå¦‚ï¼š`work`ï¼‰
3. å®æ—¶é¢„è§ˆæ˜¾ç¤ºï¼š`work@smone.us`
4. ç‚¹å‡» "âœ¨ ä½¿ç”¨ 'work' ç”Ÿæˆé‚®ç®±" æŒ‰é’®

### å¤šåŸŸåé€‰æ‹©
1. åœ¨é«˜çº§é€‰é¡¹ä¸­é€‰æ‹©ä¸åŒåŸŸå
2. ç‚¹å‡» ğŸ² éª°å­æŒ‰é’®éšæœºé€‰æ‹©åŸŸå
3. é…åˆè‡ªå®šä¹‰å‰ç¼€ä½¿ç”¨ï¼ˆå¦‚ï¼š`project@temp.email`ï¼‰

## ğŸ§ª æœ¬åœ°å¼€å‘å’Œæµ‹è¯•

### å‘é€æµ‹è¯•é‚®ä»¶

```bash
# å¿«é€Ÿå‘é€æµ‹è¯•é‚®ä»¶
pnpm run test:email

# å‘é€è‡ªå®šä¹‰æµ‹è¯•é‚®ä»¶ï¼ˆå¸¦é™„ä»¶ï¼‰
pnpm run test:email:custom [æ”¶ä»¶äºº] [å‘ä»¶äºº] [ç«¯å£] [æ˜¯å¦åŒ…å«é™„ä»¶]

# ä¾‹å¦‚ï¼š
pnpm run test:email:custom mytest@smone.us sender@example.com 5173 true
```

### æ•°æ®åº“ç®¡ç†

```bash
# æŸ¥çœ‹è¿ç§»çŠ¶æ€
pnpm run db:list

# é‡ç½®æ•°æ®åº“ï¼ˆæ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼‰
pnpm run db:reset

# é‡æ–°åº”ç”¨è¿ç§»
pnpm run db:migrate
```

è¯¦ç»†çš„æœ¬åœ°å¼€å‘æŒ‡å—è¯·æŸ¥çœ‹ï¼š[docs/local-development.md](docs/local-development.md)

## ğŸ“¦ ç”Ÿäº§ç¯å¢ƒæ„å»º

åˆ›å»ºç”Ÿäº§æ„å»ºï¼š

```bash
pnpm run build
```

## ğŸš€ éƒ¨ç½²

### ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

```bash
pnpm run deploy
```

### éƒ¨ç½²é¢„è§ˆç‰ˆæœ¬

```bash
pnpm wrangler versions upload
```

éªŒè¯åå¯ä»¥å°†ç‰ˆæœ¬æå‡åˆ°ç”Ÿäº§ç¯å¢ƒï¼š

```bash
pnpm wrangler versions deploy
```

### éƒ¨ç½²å‰å‡†å¤‡

1. **é…ç½® Cloudflare æœåŠ¡**:
   - åˆ›å»º D1 æ•°æ®åº“ï¼š`wrangler d1 create smail-database`
   - åˆ›å»º KV å‘½åç©ºé—´ï¼š`wrangler kv namespace create "smail-kv"`
   - åˆ›å»º R2 å­˜å‚¨æ¡¶ï¼š`wrangler r2 bucket create smail-attachments`
   - è®¾ç½® Email Routing

2. **é…ç½® wrangler.jsonc**:
   ç¡®ä¿ `wrangler.jsonc` åŒ…å«æ‰€æœ‰å¿…è¦é…ç½®ï¼š
   ```jsonc
   {
     "name": "your-app-name",
     "vars": {
       "SESSION_SECRET": "your-session-secret",
       "AVAILABLE_DOMAINS": "smone.us,temp.example.com,mail.yourdomain.org"
     },
     "d1_databases": [
       {
         "binding": "DB",
         "database_name": "smail-database",
         "database_id": "your-database-id"
       }
     ]
     // ... å…¶ä»–é…ç½®
   }
   ```

3. **è¿è¡Œè¿œç¨‹è¿ç§»**:
   ```bash
   pnpm run db:migrate:remote
   ```

### ğŸ“‹ ç¯å¢ƒå˜é‡ç®¡ç†

**â— é‡è¦æç¤ºï¼šä¸ºé¿å…å˜é‡åœ¨éƒ¨ç½²æ—¶è¢«æ¸…ç©º**

- âœ… **æ¨è**ï¼šåœ¨ `wrangler.jsonc` çš„ `vars` å­—æ®µä¸­é…ç½®
- âŒ **ä¸æ¨è**ï¼šä»…åœ¨ Cloudflare Dashboard ä¸­é…ç½®ï¼ˆå¯èƒ½è¢«æ¸…ç©ºï¼‰
- ğŸ“ **å¼€å‘æ—¶**ï¼šä½¿ç”¨ `.dev.vars` æ–‡ä»¶

**æ·»åŠ æ–°å˜é‡çš„æ­¥éª¤ï¼š**
1. åœ¨ `wrangler.jsonc` çš„ `vars` ä¸­æ·»åŠ 
2. é‡æ–°éƒ¨ç½²ï¼š`pnpm run deploy`
3. å˜é‡ä¼šæŒä¹…ä¿å­˜ï¼Œä¸ä¼šè¢«æ¸…ç©º

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ app/                    # åº”ç”¨ä»£ç 
â”‚   â”œâ”€â”€ components/         # React ç»„ä»¶
â”‚   â”œâ”€â”€ db/                 # æ•°æ®åº“ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ migrations/     # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ schema.ts       # æ•°æ®åº“æ¨¡å¼å®šä¹‰
â”‚   â”œâ”€â”€ lib/                # å·¥å…·å‡½æ•°å’Œæ•°æ®åº“æ“ä½œ
â”‚   â””â”€â”€ routes/             # è·¯ç”±ç»„ä»¶
â”œâ”€â”€ workers/                # Cloudflare Workers
â”‚   â””â”€â”€ app.ts              # Email Worker
â”œâ”€â”€ scripts/                # å¼€å‘è„šæœ¬
â”‚   â”œâ”€â”€ test-email.js       # é‚®ä»¶æµ‹è¯•è„šæœ¬
â”‚   â””â”€â”€ test-email.sh       # Shell æµ‹è¯•è„šæœ¬
â”œâ”€â”€ docs/                   # æ–‡æ¡£
â””â”€â”€ wrangler.jsonc          # Cloudflare é…ç½®
```

## ğŸ¨ æ ·å¼

é¡¹ç›®ä½¿ç”¨ [Tailwind CSS](https://tailwindcss.com/) è¿›è¡Œæ ·å¼è®¾è®¡ï¼Œæ”¯æŒï¼š
- å“åº”å¼è®¾è®¡
- æš—è‰²æ¨¡å¼
- ç°ä»£åŒ– UI ç»„ä»¶
- è‡ªå®šä¹‰è®¾è®¡ç³»ç»Ÿ

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·ï¼š

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

## ğŸ›Ÿ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
- æŸ¥çœ‹ [æœ¬åœ°å¼€å‘æŒ‡å—](docs/local-development.md)
- æäº¤ GitHub Issue
- æŸ¥çœ‹ Cloudflare Workers æ–‡æ¡£

---

ä½¿ç”¨ â¤ï¸ å’Œ React Router æ„å»ºã€‚
